function bindProperty(e,t,n,a,s,r){return n(autoCancelPrevious(function(n){if(!s.isActive)try{s.isActive=!0,r&&console.log("SET",r.targetPath,"TO",n,"ON",e,"BECAUSE",r.sourcePath,Error("here").stack),Array.isArray(e)&&t>>>0===t?e.set(t,n):e[t]=n}finally{s.isActive=!1}}),a)}function makePropertyBinder(e,t){return function(n,a,s,r,i){return t(autoCancelPrevious(function(t){return null!=t?e(autoCancelPrevious(function(e){return null!=e?e.bindProperty?e.bindProperty(t,n,a,r,i):_bindProperty(e,t,n,a,r,i):void 0}),s):void 0}),s)}}function bindGet(e,t,n,a,s,r){return n(autoCancelPrevious(function(n){if(!s.isActive)try{s.isActive=!0,r&&console.log("SET FOR KEY",t,"TO",n,"ON",e,"BECAUSE",r.sourcePath,Error("here").stack),e.set(t,n)}finally{s.isActive=!1}}),a)}function makeGetBinder(e,t){return function(n,a,s,r,i){return e(autoCancelPrevious(function(e){return e?t(autoCancelPrevious(function(t){return null!=t?_bindGet(e,t,n,a,r,i):void 0}),s):void 0}),s)}}function makeHasBinder(e,t){return function(n,a,s,r,i){return e(autoCancelPrevious(function(e){return e?t(autoCancelPrevious(function(t){return n(autoCancelPrevious(function(n){if(n)(e.has||e.contains).call(e,t)||(i&&console.log("ADD",t,"TO",i.targetPath,"BECAUSE",i.sourcePath,Error("here").stack),e.add(t));else for(;(e.has||e.contains).call(e,t);)i&&console.log("REMOVE",t,"FROM",i.targetPath,"BECAUSE",i.sourcePath,Error("here").stack),(e.remove||e["delete"]).call(e,t)}),a)}),s):void 0}),s)}}function makeEqualityBinder(e,t){return function(n,a,s,r,i){return n(autoCancelPrevious(function(n){return n?(i&&console.log("BIND",i.targetPath,"TO",i.sourcePath,Error("here").stack),e(t,a,a,r,i),function(){i&&console.log("UNBIND",i.targetPath,"FROM",i.sourcePath,Error("here").stack)}):void 0}),s)}}function makeEveryBlockBinder(e,t,n){return function(a,s,r,i,o){return a(autoCancelPrevious(function(a){return a?e(autoCancelPrevious(function(e){function a(e,a,l){s.swap(l,a.length,e.map(function(e){var a=Scope.nest(r,e);return t(n,a,a,i,o)}))}if(e){var s=[],l=observeRangeChange(e,a,r);return function(){cancelEach(s),l()}}}),r):void 0}),s)}}function makeAndBinder(e,t,n,a,s,r){var i=makeNotObserver(a),o=makeAndObserver(n,i);return function(n,a,i,l,c){return n(autoCancelPrevious(function(n){if(null!=n){if(n){var a=e(s,trueScope,i,l,c),p=t(r,trueScope,i,l,c);return function(){a(),p()}}return e(o,i,i,l,c)}}),a)}}function makeOrBinder(e,t,n,a,s,r){var i=makeNotObserver(a),o=makeOrObserver(n,i);return function(n,a,i,l,c){return n(autoCancelPrevious(function(n){if(null!=n){if(n)return e(o,i,i,l,c);var a=e(s,falseScope,i,l,c),p=t(r,falseScope,i,l,c);return function(){a(),p()}}}),a)}}function makeConditionalBinder(e,t,n){return function(a,s,r,i,o){return e(autoCancelPrevious(function(e){return null!=e?e?t(a,s,r,i,o):n(a,s,r,i,o):void 0}),s)}}function makeRangeContentBinder(e,t){return function(n,a,s,r,i){return e(autoCancelPrevious(function(e){return e?n(autoCancelPrevious(function(t){function n(t,n,a){isActive(e)||(i&&console.log("SWAPPING",n,"FOR",t,"AT",a,"ON",i.targetPath,Error("here").stack),e.swap?e.swap(a,n.length,t):e.add&&(e.remove||e["delete"])&&(t.forEach(e.add,e),n.forEach(e.remove||e["delete"],e)))}if(t!==e){if(!t)return e.clear(),void 0;if(!t.addRangeChangeListener)throw Error("Can't bind rangeContent() from object that does not support range content change listeners: "+t);return t.addRangeChangeListener(n),n(Array.from(t),Array.from(e),0),once(function(){t.removeRangeChangeListener(n)})}}),a):t(Observers.makeLiteralObserver([]),a,s,r,i)}),s)}}function makeMapContentBinder(e){return function(t,n,a,s,r){return e(autoCancelPrevious(function(e){return e?t(autoCancelPrevious(function(t){function n(t,n){if(!s.isActive)try{s.isActive=!0,void 0===t?(r&&r&&console.log("DELETED",r.targetPath,"FOR KEY",n,"ON",e,"BECAUSE",r.sourcePath,Error("here").stack),Array.isArray(e)?e.splice(n,1):e["delete"](n)):(r&&r&&console.log("SET",r.targetPath,"FOR KEY",n,"TO",t,"ON",e,"BECAUSE",r.sourcePath,Error("here").stack),e.set(n,t))}finally{s.isActive=!1}}return t?(e.clear(),t.forEach(n),t.addMapChangeListener(n)):(e.clear(),void 0)}),n):void 0}),a)}}function makeReversedBinder(e){return function(t,n,a){return e(autoCancelPrevious(function(e){return e?t(autoCancelPrevious(function(t){function n(t,n,a){if(!isActive(e)){var s=e.length-a-n.length;e.swap(s,n.length,t.reversed())}}return t?(t.addRangeChangeListener(n),n(t,e,0),once(function(){t.removeRangeChangeListener(n)})):(e.clear(),void 0)}),n):void 0}),a)}}function isActive(e){return e.getRangeChangeDescriptor&&e.getRangeChangeDescriptor().isActive}var Scope=require("./scope"),Observers=require("./observers"),autoCancelPrevious=Observers.autoCancelPrevious,once=Observers.once,observeRangeChange=Observers.observeRangeChange,cancelEach=Observers.cancelEach,makeNotObserver=Observers.makeNotObserver,makeOrObserver=Observers.makeOrObserver,makeAndObserver=Observers.makeAndObserver,observeValue=Observers.observeValue,trueScope=new Scope(!0),falseScope=new Scope(!1);exports.bindProperty=bindProperty;var _bindProperty=bindProperty;exports.makePropertyBinder=makePropertyBinder,exports.bindGet=bindGet;var _bindGet=bindGet;exports.makeGetBinder=makeGetBinder,exports.makeHasBinder=makeHasBinder,exports.makeEqualityBinder=makeEqualityBinder,exports.makeEveryBlockBinder=makeEveryBlockBinder,exports.makeAndBinder=makeAndBinder,exports.makeOrBinder=makeOrBinder,exports.makeConditionalBinder=makeConditionalBinder,exports.makeRangeContentBinder=makeRangeContentBinder,exports.makeMapContentBinder=makeMapContentBinder,exports.makeReversedBinder=makeReversedBinder;