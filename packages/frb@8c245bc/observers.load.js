montageDefine("8c245bc","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(e,t){function n(e){return function(t){return t(e)||Function.noop}}function a(e,t){return e(t.value)||Function.noop}function s(e,t){return e(t.parameters)||Function.noop}function r(e){return function(t,n){return t(n.document.getElementById(e))||Function.noop}}function i(e,t){return function(n,a){var s=a.components,r=s.getObjectByLabel||s.getComponentByLabel,i=r.call(s,e);return t.component=i,n(i)||Function.noop}}function o(e,t,n,a){function s(e,t,a){r(),r=n(e,t,a)||Function.noop}if(null==e)return n();var r=Function.noop;return ut.addOwnPropertyChangeListener(e,t,s,a.beforeChange),s(e[t],t,e),pt(function(){r(),ut.removeOwnPropertyChangeListener(e,t,s,a.beforeChange)})}function l(e,t){return function(n,a){return t(ct(function(t){return null==t?n():e(ct(function(e){return null==e?n():e.observeProperty?e.observeProperty(t,n,a):bt(e,t,n,a)}),a)}),a)}}function c(e,t,n,a){function s(e,a,s){i(t,a)&&(r(),r=n(e,t,s)||Function.noop)}var r=Function.noop,i=e.contentEquals||Object.equals;return s(e.get(t),t,e),e.addMapChangeListener(s,a.beforeChange),pt(function(){r(),e.removeMapChangeListener(s)})}function p(e,t){return function(n,a){return e(ct(function(e){return e?t(ct(function(t){return null==t?n():e.observeGet?e.observeGet(t,n,a):yt(e,t,n,a)}),a):n()}),a)}}function u(e,t){return function(n,a){return n=ot(n),t(ct(function(t){return e(ct(function(e){return e?H(e,function(){return n((e.has||e.contains).call(e,t))},a):n()}),a)}),a)}}function h(e){return function(t,n){for(var a=Array(e.length),s=0;e.length>s;s++)a[s]=void 0;var r=e.map(function(e,t){return e(function(e){a.set(t,e)},n)}),i=t(a)||Function.noop;return pt(function(){i(),lt(r)})}}function d(e){return function(t,n){var a={},s={};for(var r in e)(function(e,t){a[e]=t(function(t){s[e]=t},n)})(r,e[r]);var i=t(s)||Function.noop;return function(){i();for(var e in a)a[e]()}}}function m(){return h(Array.prototype.slice.call(arguments))}function g(e){return function(){var t=h(Array.prototype.slice.call(arguments)),n=G(t);return function(t,a){return n(ct(function(n){return n.every(vt.defined)?t(e.apply(void 0,n)):t()}),a)}}}function f(e){var t=e.slice(0,1).toUpperCase()+e.slice(1),n="make"+t+"Observer",a="observe"+t;return function(){var t=arguments[0],s=Array.prototype.slice.call(arguments,1),r=s.map(function(e){return function(t,n){return e(ct(t),n)}}),i=h(s),o=G(i);return function(s,i){return t(ct(function(t){return t?t[n]?t[n].apply(t,r)(s,i):t[a]?t[a](s,i):o(ct(function(n){if(!n.every(vt.defined))return s();if(t[e])return s(t[e].apply(t,n));throw Error("Object has no method "+JSON.stringify(e)+": "+t)}),i):s()}),i)}}}function v(e){return function(t,n){return e(ct(function(e){return t(!e)}),n)}}function b(e,t){return function(n,a){return e(ct(function(e){return e?t(n,a):n(e)}),a)}}function y(e,t){return function(n,a){return e(ct(function(e){return e?n(e):t(n,a)}),a)}}function w(e,t,n){return function(a,s){return e(ct(function(e){return null==e?a():e?t(a,s):n(a,s)}),s)}}function _(e){return function(t,n){return e(ct(function(e){return t(null!=e)}),n)}}function x(e,t){return function(n,a){return e(ct(function(e){return null==e?t(n,a):n(e)}),a)}}function E(e,t){return function(n,a){return e(ct(function(e){function s(t){for(;e.length>t;t++)o[t].index=t}function r(e,n,r){o.swap(r,n.length,e.map(function(e,t){return{index:r+t}})),s(r+e.length);var c,p=[];lt(l.swap(r,n.length,e.map(function(e,n){var s=o[r+n];return t(ct(function(e){c?i.set(s.index,e):p[n]=e}),ft.nest(a,e))}))),c=!0,i.swap(r,n.length,p)}if(!e)return n();var i=[],o=[],l=[],c=H(e,r,a),p=n(i,e)||Function.noop;return pt(function(){p(),lt(l),c()})}),a)}}function C(e,t){var n=E(e,t);return function(e,t){return n(ct(function(n,a){function s(e){for(;n.length>e;e++)l[e+1]=l[e]+n[e]}function r(e,t,n){var r=a.slice(n,n+e.length),o=t.map(Boolean).sum(),c=r.filter(function(t,n){return e[n]}),p=l[n],u=i.slice(p,p+o);(u.length!==c.length||u.every(function(e,t){return e!==c[t]}))&&i.swap(p,o,c),s(p)}if(!a)return e();var i=[],o=[],l=[0],c=H(n,r,t),p=e(i)||Function.noop;return pt(function(){p(),lt(o),c()})}),t)}}function T(e,t){var n=k(t),a=E(e,n),s=function(e,t){return a(ct(function(n){function a(e,t){r.addEach(e),r.deleteEach(t)}if(!n)return e();var s=[],r=ht(s,function(e,t){return Object.equals(e[1],t[1])},function(e,t){return Object.compare(e[1],t[1])}),i=H(n,a,t),o=e(s)||Function.noop;return function(){o(),i()}}),t)};return wt(s,$)}function k(e){return function(t,n){return e(ct(function(e){return t([n.value,e])||Function.noop}),n)}}function S(e){return function(t,n){return e(ct(function(e){function a(e,t,n){var a=s.length-n-t.length;s.swap(a,t.length,e.reversed())}if(!e)return t();var s=[],r=H(e,a,n),i=t(s);return pt(function(){i(),r()})}),n)}}function j(e){return function(t,n){return e(ct(function(e){function a(t){for(var n=t;e.length>n;n++)l[n].index=n,o[n+1]=e[n]?o[n]+e[n].length:o[n]}function s(e,t,s){var c=o[s],p=o[s+t.length],u=p-c;r.swap(c,u,[]),l.swap(s,t.length,e.map(function(){return{index:null}})),a(s),lt(i.swap(s,t.length,e.map(function(e,t){function i(e,t,n){a(c.index);var s=o[c.index]+n,i=o[c.index]+n+t.length,l=i-s;r.swap(s,l,e)}var c=l[s+t];return H(e,i,n)})))}if(!e)return t();var r=[],i=[],o=[0],l=[],c=H(e,s,n),p=t(r)||Function.noop;return pt(function(){p(),lt(i),c()})}),n)}}function M(){return xt(h(Array.prototype.slice.call(arguments)))}function P(e,t){var n=_t(e,t),a=l(n,Et);return nt(a,Boolean)}function O(e,t){var n=nt(t,vt.not),a=_t(e,n),s=l(a,Et);return nt(s,vt.not)}function D(e,t){var n=A(e,t);return Ct(n)}function A(e,t){var n=k(t),a=E(e,n);return function(e,t){return a(ct(function(n,a){function s(e,t){var n=mt();t.forEach(function(e){var t=r.get(e[1]);t["delete"](e[0]),n.add(e[1])}),e.forEach(function(e){r.has(e[1])||r.set(e[1],a.constructClone());var t=r.get(e[1]);t.add(e[0])}),n.forEach(function(e){var t=r.get(e);0===t.length&&r["delete"](e)})}if(!n)return e();var r=dt(),i=H(n,s,t),o=e(r)||Function.noop;return function(){i(),o()}}),t)}}function I(e,t,n){function a(e,t){return Object.compare(e[1],t[1])*n}function s(e,t){return Object.equals(e[1],t[1])}var r=k(t),i=E(e,r);return function(e,t){return i(ct(function(n){function r(e,t){o.addEach(e),o.deleteEach(t)}function i(t,n){return 0===n?t?e(t[0]):e():void 0}if(!n)return e();var o=new gt(null,s,a),l=H(n,r,t),c=K(o,i,t);return function(){l(),c()}}),t)}}function L(e,t){return I(e,t,1)}function B(e,t){return I(e,t,-1)}function z(e){return function(t){return function(n,a){return n=ot(n),t(ct(function(t){if(!t)return n();var s=e(t,n);return H(t,function(e,t,a){return n(s(e,t,a))},a)}),a)}}}function N(e,t,n){return function(a,s){return e(ct(function(e){return e?n(ct(function(n){return null==n?a():t(ct(function(t){function r(a,s,r){var o=a.length-s.length;t>r&&0>o&&n>o?(i.swap(i.length,0,e.slice(t+n+o,t+n)),i.splice(0,-o)):t>r&&o>0&&n>o?(i.swap(0,0,e.slice(t,t+o)),i.splice(i.length-o,o)):r>=t&&0>o&&t+n>r?(i.swap(i.length,0,e.slice(t+n+o,t+n)),i.splice(r-t,-o)):r>=t&&o>0&&t+n>r?(i.swap(r-t,0,e.slice(r,r+o)),i.splice(i.length-o,o)):t+n>r&&i.swap(0,i.length,e.slice(t,t+n))}if(null==t)return a();var i=[],o=H(e,r,s),l=a(i)||Function.noop;return pt(function(){l(),o()})}),s)}),s):a()}),s)}}function q(e){return function(t,n){return e(ct(function(e){function a(e){for(;r.length>e;e++)r[e].set(0,e)}function s(e,t,n){r.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),a(n+e.length)}if(!e)return t();var r=[],i=H(e,s,n),o=t(r)||Function.noop;return function(){o(),i()}}),n)}}function R(e){return function(t,n){var a=[],s=t(a)||Function.noop,r=e(function(e){if(e>>>=0,null==e)a.clear();else if(e>a.length){for(var t=[],n=a.length;e>n;n++)t.push(n);a.swap(a.length,0,t)}else a.length>e&&a.splice(e,a.length)},n);return function(){s(),r()}}}function F(e,t){return function(n,a){return t(function(t){var s=RegExp("^"+RegExp.escape(t));return e(function(e){return n(s.test(e))||Function.noop},a)},a)}}function W(e,t){return function(n,a){return t(function(t){var s=RegExp(RegExp.escape(t)+"$");return e(function(e){return n(s.test(e))||Function.noop},a)},a)}}function U(e,t){return function(n,a){return t(function(t){var s=RegExp(RegExp.escape(t));return e(function(e){return n(s.test(e))||Function.noop},a)},a)}}function H(e,t,n){function a(e,n,a){s(),s=t(e,n,a)||Function.noop}if(e){var s=Function.noop;if(!e.toArray)throw Error("Can't observe range changes on "+e+" because it has no toArray method");if(!e.addRangeChangeListener)throw Error("Can't observe range changes on "+e);a(e.toArray(),[],0);var r=e.addRangeChangeListener(a,n.beforeChange);return pt(function(){s(),r()})}}function G(e){return function(t,n){return e(ct(function(e){return e&&e.addRangeChangeListener?H(e,function(){return t(e)},n):t(e)}),n)}}function Y(e){return function(t,n){return e(ct(function(e){return e&&e.addMapChangeListener?K(e,function(){return t(e)},n):t(e)}),n)}}function K(e,t,n){function a(e,n,a){var r=s.get(n)||Function.noop;r(),r=t(e,n,a)||Function.noop,s.set(n,r)}var s=dt();e.forEach(a);var r=e.addMapChangeListener(a,n.beforeChange);return pt(function(){s.forEach(function(e){e()}),r()})}function V(e){return function(t,n){return e(ct(function(e){return e?X(e,t,n):t()}),n)}}function X(e,t,n){function a(e,t){var n,a;r.has(t)?null==e?(n=r.get(t),r["delete"](t),a=s.indexOf(n),s.splice(a,1)):(n=r.get(t),n.set(1,e)):(n=[t,e],r.set(t,n),s.push(n))}var s=[],r=dt(),i=t(s)||Function.noop,o=K(e,a,n);return pt(function(){i(),o()})}function J(e){var t=Ct(e);return wt(t,$)}function $(e,t){return t.value?e(t.value[0])||Function.noop:e()}function Z(e){var t=Ct(e);return wt(t,Q)}function Q(e,t){return t.value?e(t.value[1])||Function.noop:e()}function et(e){return function(t,n){var a=dt(),s=t(a)||Function.noop,r=e(ct(function(e){if(a.clear(),e&&!e.addRangeChangeListener){var t=Object.keys(e).map(function(t){return bt(e,t,ct(function(e){a.set(t,e)}),n)});return function(){lt(t)}}}),n);return function(){s(),r()}}}function tt(e){return function(t,n){return e(t,n.parent||new ft)}}function nt(e,t,n){return function(a,s){return a=ot(a),e(ct(function(e){return a(t.call(n,e))}),s)}}function at(e,t,n){return function(a,s){return a=ot(a),e(ct(function(e){return e&&e.every(vt.defined)?a(t.apply(n,e)):void 0}),s)}}function st(t,n){var a=e("./parse"),s=e("./compile-observer");return function(e,r){return e=ot(e),n(ct(function(n){if(null==n)return e();var i,o;try{i=a(n),o=s(i)}catch(l){return e()}return t(ct(function(t){return o(e,ft.nest(r,t))}),r)}),r)}}function rt(e,t){return function(n,a){return e(ct(function(e){return t(ct(function(e){return n(e)}),ft.nest(a,e))}),a)}}function it(e){return function(){var t=e.apply(this,arguments);return function(e,n){var a=[],s=t(ct(function(e){function t(e,t,n){a.swap(n,t.length,e)}if(e){Tt(a,e);var s=e.addRangeChangeListener(t,n.beforeChange);return pt(s)}a.clear()}),n),r=e(a)||Function.noop;return pt(function(){s(),r()})}}}function ot(e){var t;return function(n){if(n!==t){var a=e.apply(this,arguments);return t=n,a}}}function lt(e){e.forEach(function(e){e&&e()})}function ct(e){var t=Function.noop;return function(){return t(),t=e.apply(this,arguments)||Function.noop,function(){t()}}}function pt(e){var t;return function(){return t?Function.noop:(t=!0,e.apply(this,arguments))}}e("collections/shim");var ut=e("collections/listen/property-changes");e("collections/listen/array-changes");var ht=e("collections/sorted-array"),dt=e("collections/map"),mt=e("collections/set"),gt=e("collections/heap"),ft=e("./scope"),vt=e("./operators");t.makeLiteralObserver=n,t.observeValue=a,t.observeParameters=s,t.makeElementObserver=r,t.makeComponentObserver=i,t.observeProperty=o;var bt=o;t.makePropertyObserver=l,t.observeKey=c,t.observeGet=c;var yt=c;t.makeGetObserver=p,t.makeHasObserver=u,t.makeObserversObserver=h,t.makeRecordObserver=d,t.makeObjectObserver=d,t.makeTupleObserver=m,t.makeArrayObserver=m,t.makeOperatorObserverMaker=g,t.makeMethodObserverMaker=f,t.makeNotObserver=v,t.makeAndObserver=b,t.makeOrObserver=y,t.makeConditionalObserver=w,t.makeDefinedObserver=_,t.makeDefaultObserver=x;var wt=t.makeMapBlockObserver=it(E),_t=t.makeFilterBlockObserver=it(C);t.makeSortedBlockObserver=T,t.makeReversedObserver=it(S);var xt=t.makeFlattenObserver=it(j);t.makeConcatObserver=M,t.makeSomeBlockObserver=P,t.makeEveryBlockObserver=O,t.makeGroupBlockObserver=D,t.makeGroupMapBlockObserver=A,t.makeMaxBlockObserver=L,t.makeMinBlockObserver=B;var Et=n("length");t.makeSumObserver=z(function(){var e=0;return function(t,n){return e+=t.sum()-n.sum()}}),t.makeAverageObserver=z(function(){var e=0,t=0;return function(n,a){return e+=n.sum()-a.sum(),t+=n.length-a.length,e/t}}),t.makeViewObserver=it(N),t.makeEnumerateObserver=it(q),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=R,t.makeStartsWithObserver=F,t.makeEndsWithObserver=W,t.makeContainsObserver=U,t.observeRangeChange=H,t.makeRangeContentObserver=G,t.makeMapContentObserver=Y,t.observeMapChange=K;var Ct=t.makeItemsObserver=it(V);t.observeItems=X,t.makeKeysObserver=J,t.observeItemKey=$,t.makeValuesObserver=Z,t.observeItemValue=Q,t.makeToMapObserver=et,t.makeParentObserver=tt,t.makeConverterObserver=nt,t.makeComputerObserver=at,t.makePathObserver=st,t.makeExpressionObserver=st,t.makeWithObserver=rt,t.makeAsArrayObserver=it(Function.identity);var Tt=e("./merge").merge;t.makeUniq=ot,t.cancelEach=lt,t.autoCancelPrevious=ct,t.once=pt}});