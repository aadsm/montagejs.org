var Montage=require("montage").Montage,BitField=exports.BitField=Montage.specialize({constructor:{value:function(){this.super()}},initWithDescriptor:{enumerable:!1,value:function(e){var n;this.reset();for(n in e)this.addField(n,e[n].value);return this}},addField:{enumerable:!1,value:function(e,n){if(!(e in this)){if(this._fieldCount>=32)throw"BitField 32 fields limit reached.";this._trueValue+=this._fields[e]=this._constantsToReuse.length?this._constantsToReuse.shift():1<<this._fieldCount,Montage.defineProperty(this,e,{enumerable:!0,get:function(){return this._value===this._trueValue},set:function(n){n?this._value|=this._fields[e]:this._value&=~this._fields[e],this.value&&this.callDelegateMethod()}}),this._fieldCount++,n&&(this[e]=!0)}}},_constantsToReuse:{enumerable:!1,value:[]},removeField:{enumerable:!1,value:function(e){delete this[e],this._constantsToReuse.push(this._fields[e]),this._trueValue-=this._fields[e],delete this._fields[e]}},delegate:{enumerable:!1,value:null},callDelegateMethod:{value:function(){var e;this.delegate&&"function"==typeof(e=this.delegate.bitFieldDidBecomeTrue)&&e.call(this.delegate,this)},enumerable:!1},value:{enumerable:!1,get:function(){return this._value===this._trueValue}},_fieldCount:{enumerable:!1,value:0},_value:{enumerable:!1,value:0},_trueValue:{enumerable:!1,value:0},reset:{enumerable:!1,value:function(){this._value=0}},_fields:{enumerable:!1,value:{}},toString:{value:function(){var e,n,t=this._fields,s="";for(e=0;n=t[e];e++)s+=n+"["+(this._value&t[n])+"], ";return s}}});