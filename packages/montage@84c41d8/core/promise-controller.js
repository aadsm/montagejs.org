var Montage=require("montage").Montage,Promise=require("core/promise").Promise,PromiseController=exports.PromiseController=Montage.specialize({constructor:{value:function(){this.reset=null,this.addOwnPropertyChangeListener("promise",this),this.promise=null,this.defineBindings({"state == 'pending'":{"<-":"pending"},"state == 'fulfilled'":{"<-":"fulfilled"},"state == 'rejected'":{"<-":"rejected"},"progressState == 'determinate'":{"<-":"pending && determinate"},"progressState == 'indeterminate'":{"<-":"pending && determinate"},"progressState == 'fulfilled'":{"<-":"fulfilled"},"progressState == 'rejected'":{"<-":"rejected"}})}},handlePromiseChange:{value:function(e){var n=this;e=Promise.resolve(e),n.reset&&n.reset();var s=!1;n.reset=function(){s=!0},n.value=null,n.error=null,n.progress=0,n.determinate=!1,n.pending=!0,n.fulfilled=!1,n.rejected=!1,e.then(function(e){s||(n.fulfilled=!0,n.value=e,n.progress=1)},function(e){s||(n.rejected=!0,n.error=e)},function(e){s||(n.progress=e,n.determinate=null!=e)})}}});