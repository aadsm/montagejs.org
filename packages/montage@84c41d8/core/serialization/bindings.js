var Bindings=require("frb"),parse=require("frb/parse"),stringify=require("frb/stringify"),expand=require("frb/expand"),Scope=require("frb/scope"),Serializer=require("core/serialization").Serializer,Deserializer=require("core/serialization").Deserializer;Serializer.defineSerializationUnit("bindings",function(e,n){var s,a=Bindings.getBindings(n),t={};for(var o in a){var i=a[o],r={};if(!("serializable"in i)||i.serializable){var p=i.sourcePath,l=i.sourceSyntax;if(i.source!==n){var c=e.getObjectLabel(i.source),d=new Scope({type:"component",label:c});d.components=e,l=expand(l,d)}var d=new Scope;d.components=e,p=stringify(l,d),i.twoWay?r["<->"]=p:r["<-"]=p,i.converter?r.converter=i.converter:(r.convert=i.convert,r.revert=i.revert),i.trace&&(r.trace=!0),t[o]=r,s=!0}}return s?t:void 0}),Deserializer.defineDeserializationUnit("bindings",function(e,n,s){for(var a in s){var t=s[a];if("object"!=typeof t)throw Error("Binding descriptor must be an object, not "+typeof t);"boundObject"in t?(t.source=e.getObjectByLabel(t.boundObject),t.oneway?t["<-"]=t.boundPropertyPath:t["<->"]=t.boundPropertyPath,delete t.boundObject,delete t.boundObjectPropertyPath,delete t.oneway):t["<<->"]&&(console.warn("WARNING: <<-> in bindings is deprectated, use <-> only, please update now."),t["<->"]=t["<<->"],delete t["<<->"])}Bindings.defineBindings(n,s,{components:e})});