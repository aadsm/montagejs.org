"undefined"!=typeof window&&(document._montageTiming={},document._montageTiming.loadStartTime=Date.now(),window.addEventListener("DOMContentLoaded",function(){var e=1e3;document._montageStartBootstrappingTimeout=setTimeout(function(){document._montageStartBootstrappingTimeout=null;var e=document.documentElement;e.classList?e.classList.add("montage-app-bootstrapping"):e.className=e.className+" montage-app-bootstrapping",document._montageTiming.bootstrappingStartTime=Date.now()},e)})),function(e){"undefined"!=typeof require?e.call("undefined"!=typeof global?global:this,require,exports,module):e({},{},{})}(function(e,n){global=this,n.initMontage=function(){var e=n.getPlatform();e.bootstrap(function(t,a,s){var r=e.getParams(),o=e.getConfig(),l=s.resolve(t.getLocation(),r.montageLocation);o.makeLoader=function(e){return n.ReelLoader(e,t.makeLoader(e))},o.makeCompiler=function(e){return n.MetaCompiler(e,n.SerializationCompiler(e,n.TemplateCompiler(e,t.makeCompiler(e))))};var p=s.resolve(o.location,r["package"]||"."),c=r.applicationHash;if("object"==typeof BUNDLE){var u={},d=function(e){return u[e]=u[e]||a.defer()};global.bundleLoaded=function(e){d(e).resolve()};var h=a.defer();o.preloaded=h.promise;var m=a.resolve();BUNDLE.forEach(function(e){m=m.then(function(){return a.all(e.map(function(e){return i.load(e),d(e).promise}))})}),h.resolve(m.then(function(){delete BUNDLE,delete bundleLoaded}))}var g;if("remoteTrigger"in r){var f=a.defer();window.postMessage({type:"montageReady"},"*");var v=function(e){if(r.remoteTrigger===e.origin&&(e.source===window||e.source===window.parent))switch(e.data.type){case"montageInit":window.removeEventListener("message",v),f.resolve([e.data.location,e.data.injections]);break;case"isMontageReady":window.postMessage({type:"montageReady"},"*")}};window.addEventListener("message",v),g=f.promise.spread(function(e,n){var a=t.loadPackage({location:e,hash:c},o);return n&&(a=a.then(function(t){e=s.resolve(e,".");var a,r,i=n.packageDescriptions,o=n.packageDescriptionLocations,l=n.mappings,p=n.dependencies;if(i)for(r=i.length,a=0;r>a;a++)t.injectPackageDescription(i[a].location,i[a].description);if(o)for(r=o.length,a=0;r>a;a++)t.injectPackageDescriptionLocation(o[a].location,o[a].descriptionLocation);if(l)for(r=l.length,a=0;r>a;a++)t.injectMapping(l[a].dependency,l[a].name);if(p)for(r=p.length,a=0;r>a;a++)t.injectDependency(p[a].name,p[a].version);return t})),a})}else{if("autoPackage"in r)t.injectPackageDescription(p,{dependencies:{montage:"*"}},o);else if(".json"===p.slice(p.length-5)){var b=p;p=s.resolve(p,"."),t.injectPackageDescriptionLocation(p,b,o)}g=t.loadPackage({location:p,hash:c},o)}g.then(function(n){n.loadPackage({location:l,hash:r.montageHash}).then(function(e){var n;return n=r.promiseLocation?s.resolve(t.getLocation(),r.promiseLocation):s.resolve(l,"packages/mr/packages/q"),[e,e.loadPackage({location:n,hash:r.promiseHash})]}).spread(function(t,i){t.inject("core/mini-url",s),t.inject("core/promise",{Promise:a}),i.inject("q",a),o.lint=function(e){t.async("core/jshint").then(function(n){n.JSHINT(e.text)||(console.warn("JSHint Error: "+e.location),n.JSHINT.errors.forEach(function(e){e&&(console.warn("Problem at line "+e.line+" character "+e.character+": "+e.reason),e.evidence&&console.warn("    "+e.evidence))}))}).done()},global.require=n,global.montageRequire=t,e.initMontage(t,n,r)})}).done()})};var t=/((.*)\.reel)\/\2$/,a=function(e,n){return n};n.SerializationCompiler=function(e,n){return function(e){if(n(e),e.factory){var s=e.factory;return e.factory=function(e,n,r){s.call(this,e,n,r);for(var i in n){var o=n[i];if(o instanceof Object){if(o.hasOwnProperty("_montage_metadata")&&!o._montage_metadata.isInstance)o._montage_metadata.aliases.push(i),o._montage_metadata.objectName=i;else if(!Object.isSealed(o)){var l=r.id.replace(t,a);Object.defineProperty(o,"_montage_metadata",{value:{require:e,module:l,moduleId:l,property:i,objectName:i,aliases:[i],isInstance:!1}})}}else;}},e}}};var s=/([^\/]+)\.reel$/;n.ReelLoader=function(e,n){return function(e,t){var a=s.exec(e);return a?(t.redirect=e+"/"+a[1],t):n(e,t)}};var r=/\.meta/;n.MetaCompiler=function(e,n){return function(e){var t=(e.location||"").match(r);return t?(e.exports=JSON.parse(e.text),e):n(e)}},n.TemplateCompiler=function(e,n){return function(e){if(e.location){var t=e.location.match(/(.*\/)?(?=[^\/]+\.html(?:\.load\.js)?$)/);return t?(e.dependencies=e.dependencies||[],e.exports={directory:t[1],content:e.text},Object.defineProperty(e.exports,"root",{get:function(){return"object"==typeof console&&console.warn("'root' property is deprecated on template modules.  Use 'directory' instead of root[1]"),t}}),e):(n(e),void 0)}}},n.getPlatform=function(){if("undefined"!=typeof window&&window&&window.document)return i;if("undefined"!=typeof process)return e("./node.js");throw Error("Platform not supported.")};var i={makeResolve:function(){var e=document.querySelector("base"),n=e;n||(e=document.createElement("base"),e.href="");var t=document.querySelector("head"),a=document.createElement("a");return function(s,r){if(n||t.appendChild(e),s+="",!/^[\w\-]+:/.test(s))throw Error("Can't resolve from a relative location: "+JSON.stringify(s)+" "+JSON.stringify(r));var i=e.href;e.href=s,a.href=r;var o=a.href;return e.href=i,n||t.removeChild(e),o}},load:function(e){var n=document.createElement("script");n.src=e,n.onload=function(){n.parentNode.removeChild(n)},document.getElementsByTagName("head")[0].appendChild(n)},getConfig:function(){return{location:""+window.location}},getParams:function(){var e,n,t,a,s,r,i;if(!this._params){this._params={};var o=document.getElementsByTagName("script");for(e=0;o.length>e;e++)if(a=o[e],s=!1,a.src&&(t=a.src.match(/^(.*)montage.js(?:[\?\.]|$)/i))&&(this._params.montageLocation=t[1],s=!0),a.hasAttribute("data-montage-location")&&(this._params.montageLocation=a.getAttribute("data-montage-location"),s=!0),s){if(a.dataset)for(i in a.dataset)this._params[i]=a.dataset[i];else if(a.attributes){var l=/-([a-z])/g,p=function(e,n){return n.toUpperCase()};for(n=0;a.attributes.length>n;n++)r=a.attributes[n],t=r.name.match(/^data-(.*)$/),t&&(this._params[t[1].replace(l,p)]=r.value)}a.parentNode.removeChild(a);break}}return this._params},bootstrap:function(e){function n(){document.removeEventListener("DOMContentLoaded",n,!0),o=!0,s()}function t(e){if(!f[e]&&g[e]){var n=f[e]={};f[e]=g[e](t,n)||n}return f[e]}function a(){p=t("mini-url"),l=t("promise"),r=t("require"),delete global.bootstrap,s()}function s(){o&&r&&e(r,l,p)}var r,o,l,p,c=this.getParams(),u=this.makeResolve();/interactive|complete/.test(document.readyState)?n():document.addEventListener("DOMContentLoaded",n,!0);var d={require:"packages/mr/require.js","require/browser":"packages/mr/browser.js",promise:"packages/mr/packages/q/q.js"};if("undefined"==typeof BUNDLE){var h=u(window.location,c.montageLocation);for(var m in d)i.load(u(h,d[m]))}var g={};global.bootstrap=function(e,n){g[e]=n,delete d[e];for(var e in d)return;delete global.bootstrap,a()},global.bootstrap("mini-url",function(e,n){n.resolve=u});var f={}},initMontage:function(e,n,t){var a=["core/core","core/event/event-manager","core/serialization/deserializer/montage-reviver","core/logger"],s=e("core/promise").Promise;return s.all(a.map(e.deepLoad)).then(function(){a.forEach(e);var r,i,o=e("core/core").Montage,l=e("core/event/event-manager").EventManager,p=e("core/serialization/deserializer/montage-reviver").MontageReviver,c=e("core/logger").logger;c("Promise stacktrace support",function(e){s.longStackJumpLimit=e?1:0}),r=(new l).initWithWindow(window),"function"==typeof global.montageWillLoad&&global.montageWillLoad();var u,d,h=n.packageDescription.applicationPrototype;return h?(u=p.parseObjectLocationId(h),d=n.async(u.moduleId)):d=e.async("core/application"),d.then(function(e){var a=e[u?u.objectName:"Application"];i=new a,Object.defineProperty(window.document,"application",{get:o.deprecate(null,function(){return e.application},'document.application is deprecated, use require("montage/core/application").application instead.')}),r.application=i,i.eventManager=r,i._load(n,function(){t.module&&n.async(t.module).done(),"function"==typeof global.montageDidLoad&&global.montageDidLoad()})})}).done()}};"undefined"!=typeof window?global.__MONTAGE_LOADED__?console.warn("Montage already loaded!"):(global.__MONTAGE_LOADED__=!0,n.initMontage()):n.getPlatform()});