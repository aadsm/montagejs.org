montageDefine("545ead3","fs",{dependencies:["util","path","stream","events","./lib/_stream_readable.js","./lib/_stream_writable.js"],factory:function(e,t){function n(){if(q){var e=Error();return function(t){if(t)throw e.message=t.message,t=e}}return function(e){if(e)throw e}}function a(e){return"function"==typeof e?e:n()}function s(e){return"function"!=typeof e?n():function(){return e.apply(null,arguments)}}function r(e){if(e&&!Buffer.isEncoding(e))throw Error("Unknown encoding: "+e)}function i(e,t){if(-1!==(""+e).indexOf("\0")){var n=Error("Path must be a string without null bytes.");if(!t)throw n;return process.nextTick(function(){t(n)}),!1}return!0}function o(e){if("string"!=typeof e)return e;if(!A&&~e.indexOf("x"))throw h("ENOSYS","fs.open(O_EXCL)");switch(e){case"r":return L;case"rs":return L|B;case"r+":return I;case"rs+":return I|B;case"w":return z|D|N;case"wx":case"xw":return z|D|N|A;case"w+":return z|D|I;case"wx+":case"xw+":return z|D|I|A;case"a":return P|D|N;case"ax":case"xa":return P|D|N|A;case"a+":return P|D|I;case"ax+":case"xa+":return P|D|I|A}throw Error("Unknown file open flag: "+e)}function l(e,t){switch(typeof e){case"number":return e;case"string":return parseInt(e,8);default:return t?l(t):void 0}}function c(e,t){return R?"junction"===t?w._makeLong(e):(""+e).replace(/\//g,"\\"):e}function p(e){if("number"==typeof e)return e;if(e instanceof Date)return e.getTime()/1e3;throw Error("Cannot parse time: "+e)}function u(e,t,n,s,r,i){i=a(arguments[arguments.length-1]),k.write(e,t,n,s,r,function(a,o){a?k.close(e,function(){i&&i(a)}):o===s?k.close(e,i):(n+=o,s-=o,r+=o,u(e,t,n,s,r,i))})}function h(e,t){var n=Error(t+" "+e);return n.errno=n.code=e,n.syscall=t,n}function d(){T.call(this);var e=this,t=process.binding("fs_event_wrap").FSEvent;this._handle=new t,this._handle.owner=this,this._handle.onchange=function(t,n,a){t?(e._handle.close(),e.emit("error",h(errno,"watch"))):e.emit("change",n,a)}}function m(){T.call(this);var e=this;this._handle=new x.StatWatcher;var t=-1;this._handle.onchange=function(n,a,s){(-1!==t||-1!==s||n.nlink!==a.nlink)&&(t=s,e.emit("change",n,a))},this._handle.onstop=function(){e.emit("stop")}}function f(e){return Object.prototype.hasOwnProperty.call(F,e)&&F[e]}function g(){U=new Buffer(M),U.used=0}function v(e,t){if(!(this instanceof v))return new v(e,t);if(t=_._extend({bufferSize:65536,lowWaterMark:16384,highWaterMark:65536},t||{}),S.call(this,t),this.path=e,this.fd=t.hasOwnProperty("fd")?t.fd:null,this.flags=t.hasOwnProperty("flags")?t.flags:"r",this.mode=t.hasOwnProperty("mode")?t.mode:438,this.start=t.hasOwnProperty("start")?t.start:void 0,this.end=t.hasOwnProperty("start")?t.end:void 0,this.pos=void 0,void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw Error("start must be <= end");this.pos=this.start}"number"!=typeof this.fd&&this.open(),this.on("end",function(){this.destroy()})}function b(e,t){if(!(this instanceof b))return new b(e,t);if(t=_._extend({bufferSize:65536,lowWaterMark:16384,highWaterMark:65536},t||{}),j.call(this,t),this.path=e,this.fd=null,this.fd=t.hasOwnProperty("fd")?t.fd:null,this.flags=t.hasOwnProperty("flags")?t.flags:"w",this.mode=t.hasOwnProperty("mode")?t.mode:438,this.start=t.hasOwnProperty("start")?t.start:void 0,this.pos=void 0,this.bytesWritten=0,void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(0>this.start)throw Error("start must be >= zero");this.pos=this.start}"number"!=typeof this.fd&&this.open(),this.once("finish",this.close)}function y(e){C.call(this),this.fd=e,this.writable=!0,this.readable=!1}var _=e("util"),w=e("path"),x=process.binding("fs"),E=process.binding("constants"),k=t,C=e("stream").Stream,T=e("events").EventEmitter,S=e("./lib/_stream_readable.js"),j=e("./lib/_stream_writable.js"),O=128,M=40960,P=E.O_APPEND||0,D=E.O_CREAT||0;E.O_DIRECTORY||0;var A=E.O_EXCL||0;E.O_NOCTTY||0,E.O_NOFOLLOW||0;var L=E.O_RDONLY||0,I=E.O_RDWR||0;E.O_SYMLINK||0;var B=E.O_SYNC||0,z=E.O_TRUNC||0,N=E.O_WRONLY||0,R="win32"===process.platform,q=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);k.Stats=x.Stats,k.Stats.prototype._checkModeProperty=function(e){return(this.mode&E.S_IFMT)===e},k.Stats.prototype.isDirectory=function(){return this._checkModeProperty(E.S_IFDIR)},k.Stats.prototype.isFile=function(){return this._checkModeProperty(E.S_IFREG)},k.Stats.prototype.isBlockDevice=function(){return this._checkModeProperty(E.S_IFBLK)},k.Stats.prototype.isCharacterDevice=function(){return this._checkModeProperty(E.S_IFCHR)},k.Stats.prototype.isSymbolicLink=function(){return this._checkModeProperty(E.S_IFLNK)},k.Stats.prototype.isFIFO=function(){return this._checkModeProperty(E.S_IFIFO)},k.Stats.prototype.isSocket=function(){return this._checkModeProperty(E.S_IFSOCK)},k.exists=function(e,t){function n(e){t&&t(e?!1:!0)}i(e,n)&&x.stat(w._makeLong(e),n)},k.existsSync=function(e){try{return i(e),x.stat(w._makeLong(e)),!0}catch(t){return!1}},k.readFile=function(e,t){function n(){0===c?(p=new Buffer(8192),k.read(h,p,0,8192,-1,s)):k.read(h,p,d,c-d,-1,s)}function s(e,t){return e?k.close(h,function(){return l(e)}):0===t?i():(d+=t,0!==c?d===c?i():n():(u.push(p.slice(0,t)),n()),void 0)}function i(){k.close(h,function(e){return 0===c?p=Buffer.concat(u,d):c>d&&(p=p.slice(0,d)),o&&(p=p.toString(o)),l(e,p)})}var o="string"==typeof t?t:null,l=a(arguments[arguments.length-1]);r(o);var c,p,u,h,d=0;k.open(e,E.O_RDONLY,438,function(e,t){return e?l(e):(h=t,k.fstat(h,function(e,t){return e?l(e):(c=t.size,0===c?(u=[],n()):(p=new Buffer(c),n(),void 0))}),void 0)})},k.readFileSync=function(e,t){r(t);var n,a=k.openSync(e,E.O_RDONLY,438),s=!0;try{n=k.fstatSync(a).size,s=!1}finally{s&&k.closeSync(a)}var i,o,l=0;0===n?o=[]:i=new Buffer(n);for(var c=!1;!c;){var s=!0;try{if(0!==n)var p=k.readSync(a,i,l,n-l);else{i=new Buffer(8192);var p=k.readSync(a,i,0,8192);p&&o.push(i.slice(0,p))}s=!1}finally{s&&k.closeSync(a)}l+=p,c=0===p||0!==n&&l>=n}return k.closeSync(a),0===n?i=Buffer.concat(o,l):n>l&&(i=i.slice(0,l)),t&&(i=i.toString(t)),i},Object.defineProperty(t,"_stringToFlags",{enumerable:!1,value:o}),k.close=function(e,t){x.close(e,s(t))},k.closeSync=function(e){return x.close(e)},k.open=function(e,t,n,a){a=s(arguments[arguments.length-1]),n=l(n,438),i(e,a)&&x.open(w._makeLong(e),o(t),n,a)},k.openSync=function(e,t,n){return n=l(n,438),i(e),x.open(w._makeLong(e),o(t),n)},k.read=function(e,t,n,a,s,i){function o(e,n){i&&i(e,n||0,t)}if(!Buffer.isBuffer(t)){var l=arguments[4],c=arguments[3];r(c),s=arguments[2],a=arguments[1],t=new Buffer(a),n=0,i=function(e,n){if(l){var a=n>0?t.toString(c,0,n):"";l(e,a,n)}}}x.read(e,t,n,a,s,o)},k.readSync=function(e,t,n,a,s){var i=!1;if(!Buffer.isBuffer(t)){i=!0;var o=arguments[3];r(o),s=arguments[2],a=arguments[1],t=new Buffer(a),n=0}var l=x.read(e,t,n,a,s);if(!i)return l;var c=l>0?t.toString(o,0,l):"";return[c,l]},k.write=function(e,t,n,s,i,o){function l(e,n){o(e,n||0,t)}return Buffer.isBuffer(t)||(o=arguments[4],i=arguments[2],r(arguments[3]),t=new Buffer(""+arguments[1],arguments[3]),n=0,s=t.length),s?(o=a(o),x.write(e,t,n,s,i,l),void 0):("function"==typeof o&&process.nextTick(function(){o(void 0,0)}),void 0)},k.writeSync=function(e,t,n,a,s){return Buffer.isBuffer(t)||(s=arguments[2],r(arguments[3]),t=new Buffer(""+arguments[1],arguments[3]),n=0,a=t.length),a?x.write(e,t,n,a,s):0},k.rename=function(e,t,n){n=s(n),i(e,n)&&i(t,n)&&x.rename(w._makeLong(e),w._makeLong(t),n)},k.renameSync=function(e,t){return i(e),i(t),x.rename(w._makeLong(e),w._makeLong(t))},k.truncate=function(e,t,n){return"number"==typeof e?k.ftruncate(e,t,n):("function"==typeof t?(n=t,t=0):t===void 0&&(t=0),n=a(n),k.open(e,"w",function(e,a){return e?n(e):(x.ftruncate(a,t,function(e){k.close(a,function(t){n(e||t)})}),void 0)}),void 0)},k.truncateSync=function(e,t){if("number"==typeof e)return k.ftruncateSync(e,t);t===void 0&&(t=0);var n=k.openSync(e,"w");try{var a=k.ftruncateSync(n,t)}finally{k.closeSync(n)}return a},k.ftruncate=function(e,t,n){"function"==typeof t?(n=t,t=0):t===void 0&&(t=0),x.ftruncate(e,t,s(n))},k.ftruncateSync=function(e,t){return t===void 0&&(t=0),x.ftruncate(e,t)},k.rmdir=function(e,t){t=s(t),i(e,t)&&x.rmdir(w._makeLong(e),t)},k.rmdirSync=function(e){return i(e),x.rmdir(w._makeLong(e))},k.fdatasync=function(e,t){x.fdatasync(e,s(t))},k.fdatasyncSync=function(e){return x.fdatasync(e)},k.fsync=function(e,t){x.fsync(e,s(t))},k.fsyncSync=function(e){return x.fsync(e)},k.mkdir=function(e,t,n){"function"==typeof t&&(n=t),n=s(n),i(e,n)&&x.mkdir(w._makeLong(e),l(t,511),n)},k.mkdirSync=function(e,t){return i(e),x.mkdir(w._makeLong(e),l(t,511))},k.sendfile=function(e,t,n,a,r){x.sendfile(e,t,n,a,s(r))},k.sendfileSync=function(e,t,n,a){return x.sendfile(e,t,n,a)},k.readdir=function(e,t){t=s(t),i(e,t)&&x.readdir(w._makeLong(e),t)},k.readdirSync=function(e){return i(e),x.readdir(w._makeLong(e))},k.fstat=function(e,t){x.fstat(e,s(t))},k.lstat=function(e,t){t=s(t),i(e,t)&&x.lstat(w._makeLong(e),t)},k.stat=function(e,t){t=s(t),i(e,t)&&x.stat(w._makeLong(e),t)},k.fstatSync=function(e){return x.fstat(e)},k.lstatSync=function(e){return i(e),x.lstat(w._makeLong(e))},k.statSync=function(e){return i(e),x.stat(w._makeLong(e))},k.readlink=function(e,t){t=s(t),i(e,t)&&x.readlink(w._makeLong(e),t)},k.readlinkSync=function(e){return i(e),x.readlink(w._makeLong(e))},k.symlink=function(e,t,n,a){var r="string"==typeof n?n:null,a=s(arguments[arguments.length-1]);i(e,a)&&i(t,a)&&x.symlink(c(e,r),w._makeLong(t),r,a)},k.symlinkSync=function(e,t,n){return n="string"==typeof n?n:null,i(e),i(t),x.symlink(c(e,n),w._makeLong(t),n)},k.link=function(e,t,n){n=s(n),i(e,n)&&i(t,n)&&x.link(w._makeLong(e),w._makeLong(t),n)},k.linkSync=function(e,t){return i(e),i(t),x.link(w._makeLong(e),w._makeLong(t))},k.unlink=function(e,t){t=s(t),i(e,t)&&x.unlink(w._makeLong(e),t)},k.unlinkSync=function(e){return i(e),x.unlink(w._makeLong(e))},k.fchmod=function(e,t,n){x.fchmod(e,l(t),s(n))},k.fchmodSync=function(e,t){return x.fchmod(e,l(t))},E.hasOwnProperty("O_SYMLINK")&&(k.lchmod=function(e,t,n){n=a(n),k.open(e,E.O_WRONLY|E.O_SYMLINK,function(e,a){return e?(n(e),void 0):(k.fchmod(a,t,function(e){k.close(a,function(t){n(e||t)})}),void 0)})},k.lchmodSync=function(e,t){var n,a,s=k.openSync(e,E.O_WRONLY|E.O_SYMLINK);try{var r=k.fchmodSync(s,t)}catch(i){n=i}try{k.closeSync(s)}catch(i){a=i}if(n||a)throw n||a;return r}),k.chmod=function(e,t,n){n=s(n),i(e,n)&&x.chmod(w._makeLong(e),l(t),n)},k.chmodSync=function(e,t){return i(e),x.chmod(w._makeLong(e),l(t))},E.hasOwnProperty("O_SYMLINK")&&(k.lchown=function(e,t,n,s){s=a(s),k.open(e,E.O_WRONLY|E.O_SYMLINK,function(e,a){return e?(s(e),void 0):(k.fchown(a,t,n,s),void 0)})},k.lchownSync=function(e,t,n){var a=k.openSync(e,E.O_WRONLY|E.O_SYMLINK);return k.fchownSync(a,t,n)}),k.fchown=function(e,t,n,a){x.fchown(e,t,n,s(a))},k.fchownSync=function(e,t,n){return x.fchown(e,t,n)},k.chown=function(e,t,n,a){a=s(a),i(e,a)&&x.chown(w._makeLong(e),t,n,a)},k.chownSync=function(e,t,n){return i(e),x.chown(w._makeLong(e),t,n)},k._toUnixTimestamp=p,k.utimes=function(e,t,n,a){a=s(a),i(e,a)&&x.utimes(w._makeLong(e),p(t),p(n),a)},k.utimesSync=function(e,t,n){i(e),t=p(t),n=p(n),x.utimes(w._makeLong(e),t,n)},k.futimes=function(e,t,n,a){t=p(t),n=p(n),x.futimes(e,t,n,s(a))},k.futimesSync=function(e,t,n){t=p(t),n=p(n),x.futimes(e,t,n)},k.writeFile=function(e,t,n,s){var i="string"==typeof n?n:"utf8";r(i),s=a(arguments[arguments.length-1]),k.open(e,"w",438,function(e,n){if(e)s&&s(e);else{var a=Buffer.isBuffer(t)?t:new Buffer(""+t,i);u(n,a,0,a.length,0,s)}})},k.writeFileSync=function(e,t,n){r(n);var a=k.openSync(e,"w");Buffer.isBuffer(t)||(t=new Buffer(""+t,n||"utf8"));var s=0,i=t.length;try{for(;i>s;)s+=k.writeSync(a,t,s,i-s,s)}finally{k.closeSync(a)}},k.appendFile=function(e,t,n,s){var i="string"==typeof n?n:"utf8";r(i),s=a(arguments[arguments.length-1]),k.open(e,"a",438,function(e,n){if(e)return s(e);var a=Buffer.isBuffer(t)?t:new Buffer(""+t,i);u(n,a,0,a.length,null,s)})},k.appendFileSync=function(e,t,n){r(n);var a=k.openSync(e,"a");Buffer.isBuffer(t)||(t=new Buffer(""+t,n||"utf8"));var s=0,i=null,o=t.length;try{for(;o>s;)s+=k.writeSync(a,t,s,o-s,i),i+=s}finally{k.closeSync(a)}},_.inherits(d,T),d.prototype.start=function(e,t){i(e);var n=this._handle.start(w._makeLong(e),t);if(n)throw this._handle.close(),h(errno,"watch")},d.prototype.close=function(){this._handle.close()},k.watch=function(e){i(e);var t,n,a;return"object"==typeof arguments[1]?(n=arguments[1],a=arguments[2]):(n={},a=arguments[1]),void 0===n.persistent&&(n.persistent=!0),t=new d,t.start(e,n.persistent),a&&t.addListener("change",a),t},_.inherits(m,T),m.prototype.start=function(e,t,n){i(e),this._handle.start(w._makeLong(e),t,n)},m.prototype.stop=function(){this._handle.stop()};var F={};if(k.watchFile=function(e){i(e);var t,n,a={interval:5007,persistent:!0};if("object"==typeof arguments[1]?(a=_._extend(a,arguments[1]),n=arguments[2]):n=arguments[1],!n)throw Error("watchFile requires a listener function");return f(e)?t=F[e]:(t=F[e]=new m,t.start(e,a.persistent,a.interval)),t.addListener("change",n),t},k.unwatchFile=function(e,t){if(i(e),f(e)){var n=F[e];"function"==typeof t?n.removeListener("change",t):n.removeAllListeners("change"),0===n.listeners("change").length&&(n.stop(),F[e]=void 0)}},w.normalize,R)var W=/(.*?)(?:[\/\\]+|$)/g;else var W=/(.*?)(?:[\/]+|$)/g;if(R)var H=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else var H=/^[\/]*/;k.realpathSync=function(e,t){function n(){var t=H.exec(e);a=t[0].length,s=t[0],r=t[0],i="",R&&!c[r]&&(k.lstatSync(r),c[r]=!0)}if(e=w.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var a,s,r,i,o=e,l={},c={};for(n();e.length>a;){W.lastIndex=a;var p=W.exec(e);if(i=s,s+=p[0],r=i+p[1],a=W.lastIndex,!(c[r]||t&&t[r]===r)){var u;if(t&&Object.prototype.hasOwnProperty.call(t,r))u=t[r];else{var h=k.lstatSync(r);if(!h.isSymbolicLink()){c[r]=!0,t&&(t[r]=r);continue}var d=null;if(!R){var m=h.dev.toString(32)+":"+h.ino.toString(32);l.hasOwnProperty(m)&&(d=l[m])}null===d&&(k.statSync(r),d=k.readlinkSync(r)),u=w.resolve(i,d),t&&(t[r]=u),R||(l[m]=d)}e=w.resolve(u,e.slice(a)),n()}}return t&&(t[o]=e),e},k.realpath=function(e,t,n){function s(){var t=H.exec(e);c=t[0].length,p=t[0],u=t[0],h="",R&&!f[u]?k.lstat(u,function(e){return e?n(e):(f[u]=!0,r(),void 0)}):process.nextTick(r)}function r(){if(c>=e.length)return t&&(t[d]=e),n(null,e);W.lastIndex=c;var a=W.exec(e);return h=p,p+=a[0],u=h+a[1],c=W.lastIndex,f[u]||t&&t[u]===u?process.nextTick(r):t&&Object.prototype.hasOwnProperty.call(t,u)?l(t[u]):k.lstat(u,i)}function i(e,a){if(e)return n(e);if(!a.isSymbolicLink())return f[u]=!0,t&&(t[u]=u),process.nextTick(r);if(!R){var s=a.dev.toString(32)+":"+a.ino.toString(32);if(m.hasOwnProperty(s))return o(null,m[s],u)}k.stat(u,function(e){return e?n(e):(k.readlink(u,function(e,t){R||(m[s]=t),o(e,t)}),void 0)})}function o(e,a,s){if(e)return n(e);var r=w.resolve(h,a);t&&(t[s]=r),l(r)}function l(t){e=w.resolve(t,e.slice(c)),s()}if("function"!=typeof n&&(n=a(t),t=null),e=w.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(n.bind(null,null,t[e]));var c,p,u,h,d=e,m={},f={};s()};var U;k.createReadStream=function(e,t){return new v(e,t)},_.inherits(v,S),k.ReadStream=v,k.FileReadStream=k.ReadStream,v.prototype.open=function(){var e=this;k.open(this.path,this.flags,this.mode,function(t,n){return t?(e.destroy(),e.emit("error",t),void 0):(e.fd=n,e.emit("open",n),e.read(),void 0)})},v.prototype._read=function(e,t){function n(e,n){if(e)return i.destroy(),t(e);var s=null;n>0&&(s=a.slice(r,r+n)),t(null,s)}if("number"!=typeof this.fd)return this.once("open",function(){this._read(e,t)});if(!this.destroyed){(!U||O>U.length-U.used)&&(U=null,g());var a=U,s=Math.min(U.length-U.used,e),r=U.used;if(void 0!==this.pos&&(s=Math.min(this.end-this.pos+1,s)),0>=s)return t();var i=this;k.read(this.fd,U,U.used,s,this.pos,n),void 0!==this.pos&&(this.pos+=s),U.used+=s}},v.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,"number"==typeof this.fd&&this.close())},v.prototype.close=function(e){function t(){k.close(n.fd,function(e){e?n.emit("error",e):n.emit("close")})}if(e&&this.once("close",e),this.closed||"number"!=typeof this.fd)return"number"!=typeof this.fd&&this.once("open",t),process.nextTick(this.emit.bind(this,"close"));this.closed=!0;var n=this;t()},k.createWriteStream=function(e,t){return new b(e,t)},_.inherits(b,j),k.WriteStream=b,k.FileWriteStream=k.WriteStream,b.prototype.open=function(){k.open(this.path,this.flags,this.mode,function(e,t){return e?(this.destroy(),this.emit("error",e),void 0):(this.fd=t,this.emit("open",t),void 0)}.bind(this))},b.prototype._write=function(e,t){return Buffer.isBuffer(e)?"number"!=typeof this.fd?this.once("open",this._write.bind(this,e,t)):(k.write(this.fd,e,0,e.length,this.pos,function(e,n){return e?(this.destroy(),t(e)):(this.bytesWritten+=n,t(),void 0)}.bind(this)),void 0!==this.pos&&(this.pos+=e.length),void 0):this.emit("error",Error("Invalid data"))},b.prototype.destroy=v.prototype.destroy,b.prototype.close=v.prototype.close,b.prototype.destroySoon=b.prototype.end,_.inherits(y,C),k.SyncWriteStream=y,y.prototype.write=function(e,t,n){var a,s;if(t)if("string"==typeof t)a=t,s=n;else{if("function"!=typeof t)throw Error("bad arg");s=t}return r(a),"string"==typeof e&&(e=new Buffer(e,a)),k.writeSync(this.fd,e,0,e.length),s&&process.nextTick(s),!0},y.prototype.end=function(e,t,n){e&&this.write(e,t,n),this.destroy()},y.prototype.destroy=function(){return k.closeSync(this.fd),this.fd=null,this.emit("close"),!0},y.prototype.destroySoon=y.prototype.destroy}});