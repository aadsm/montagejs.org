montageDefine("545ead3","test/simple/test-stream2-large-read-stall",{dependencies:["../common.js","assert","../../readable"],factory:function(e){function t(){if(!(u>r)){if(u++===r)return console.error("   push(EOF)"),l.push(null);console.error("   push #%d",u),l.push(new Buffer(s))&&setTimeout(t)}}e("../common.js");var n=e("assert"),a=100,s=20,r=1e3,i=50,o=e("../../readable").Readable,l=new o({highWaterMark:i}),c=l._readableState;l._read=t,l.on("readable",function(){console.error(">> readable");do{console.error("  > read(%d)",a);var e=l.read(a);console.error("  < %j (%d remain)",e&&e.length,c.length)}while(e&&e.length===a);console.error("<< after read()",e&&e.length,c.needReadable,c.length)});var p=!1;l.on("end",function(){p=!0,console.error("end")});var u=0;l.read(0),process.on("exit",function(){n.equal(u,r+1),n(p)})}});