montageDefine("545ead3","test/simple/test-stream2-unpipe-drain",{dependencies:["../common.js","assert","../../readable","crypto","util"],factory:function(e){function t(){s.Writable.call(this)}function n(){s.Readable.call(this),this.reads=0}e("../common.js");var a=e("assert"),s=e("../../readable"),r=e("crypto"),i=e("util");i.inherits(t,s.Writable),t.prototype._write=function(){console.log("write called")};var o=new t;i.inherits(n,s.Readable),n.prototype._read=function(e){this.reads+=1,this.push(r.randomBytes(e))};var l=new n,c=new n;l.pipe(o),l.once("readable",function(){process.nextTick(function(){c.pipe(o),c.once("readable",function(){process.nextTick(function(){l.unpipe(o)})})})}),process.on("exit",function(){a.equal(l.reads,2),a.equal(c.reads,2)})}});